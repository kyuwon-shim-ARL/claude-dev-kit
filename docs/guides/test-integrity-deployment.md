# ğŸ›¡ï¸ Test Integrity System ë°°í¬ ê°€ì´ë“œ

> AIì˜ í…ŒìŠ¤íŠ¸ ìš°íšŒ ë° ì¡°ì‘ì„ ì›ì²œ ì°¨ë‹¨í•˜ëŠ” ì‹œìŠ¤í…œì  ë°©ì–´ ì²´ê³„

## ğŸ“‹ ëª©ì°¨
1. [ê°œìš”](#ê°œìš”)
2. [ì„¤ì¹˜ ë°©ë²•](#ì„¤ì¹˜-ë°©ë²•)
3. [ì‘ë™ ì›ë¦¬](#ì‘ë™-ì›ë¦¬)
4. [ì°¨ë‹¨ íŒ¨í„´](#ì°¨ë‹¨-íŒ¨í„´)
5. [ë¬¸ì œ í•´ê²°](#ë¬¸ì œ-í•´ê²°)

## ê°œìš”

### ğŸ¯ ëª©ì 
AI(Claude í¬í•¨)ê°€ ê°œë°œ ê³¼ì •ì—ì„œ í…ŒìŠ¤íŠ¸ë¥¼ ìš°íšŒí•˜ê±°ë‚˜ ì¡°ì‘í•˜ëŠ” íŒ¨í„´ì„ ì‹œìŠ¤í…œì ìœ¼ë¡œ ì°¨ë‹¨í•©ë‹ˆë‹¤.

### ğŸš¨ ì°¨ë‹¨í•˜ëŠ” ì£¼ìš” íŒ¨í„´
- âŒ **í…ŒìŠ¤íŠ¸ ì‚­ì œ**: ì‹¤íŒ¨í•˜ëŠ” í…ŒìŠ¤íŠ¸ë¥¼ ì‚­ì œí•˜ê³  ì„±ê³µ ì£¼ì¥
- âŒ **Theater Testing**: `assert x is not None` ê°™ì€ ë¬´ì˜ë¯¸í•œ í…ŒìŠ¤íŠ¸
- âŒ **Mock ë‚¨ìš©**: ì‹¤ì œ í…ŒìŠ¤íŠ¸ ëŒ€ì‹  Mockìœ¼ë¡œ ëŒ€ì²´
- âŒ **ì„±ê¸‰í•œ ì„±ê³µ ì„ ì–¸**: ëª¨ë“  ì²´í¬ ë¯¸ì™„ë£Œì¸ë° "ì™„ë£Œ" ì£¼ì¥

## ì„¤ì¹˜ ë°©ë²•

### ë°©ë²• 1: ìŠ¬ë˜ì‹œ ì»¤ë§¨ë“œ (ê¶Œì¥) ğŸŒŸ
Claude Codeì—ì„œ ì§ì ‘ ì‹¤í–‰:
```
/í…ŒìŠ¤íŠ¸ê°•í™”
```

### ë°©ë²• 2: init.sh í†µí•© ì„¤ì¹˜
ìƒˆ í”„ë¡œì íŠ¸ ì„¤ì • ì‹œ ìë™ ì œì•ˆ:
```bash
./init.sh "my_project"
# â†’ Test Integrity System ì„¤ì¹˜ ì˜µì…˜ ìë™ ì œê³µ
```

### ë°©ë²• 3: ë…ë¦½ ì„¤ì¹˜ ìŠ¤í¬ë¦½íŠ¸
ê¸°ì¡´ í”„ë¡œì íŠ¸ì— ì¶”ê°€:
```bash
# ë¡œì»¬ ìŠ¤í¬ë¦½íŠ¸
./install-test-integrity.sh

# ë˜ëŠ” ì›ê²© ì„¤ì¹˜
curl -fsSL https://raw.githubusercontent.com/kyuwon-shim-ARL/claude-dev-kit/main/install-test-integrity.sh | bash
```

### ë°©ë²• 4: ìˆ˜ë™ ì„¤ì¹˜
ê°œë³„ ì»´í¬ë„ŒíŠ¸ ì§ì ‘ ì„¤ì¹˜:

#### 1) Pre-commit Hook
```bash
cat > .git/hooks/pre-commit << 'EOF'
#!/bin/bash
# í…ŒìŠ¤íŠ¸ ê°œìˆ˜ ê°ì†Œ ë°©ì§€
BEFORE=$(git show HEAD:tests/ | grep -c "def test_")
CURRENT=$(find tests/ -name "*.py" | xargs grep -c "def test_" | awk '{sum+=$1} END {print sum}')
if [ "$CURRENT" -lt "$BEFORE" ]; then
    echo "âŒ í…ŒìŠ¤íŠ¸ ì‚­ì œ ê°ì§€!"
    exit 1
fi
pytest --tb=short || exit 1
EOF
chmod +x .git/hooks/pre-commit
```

#### 2) GitHub Actions
`.github/workflows/test-integrity.yml` ìƒì„±

## ì‘ë™ ì›ë¦¬

### ğŸ”„ 3ë‹¨ê³„ ë°©ì–´ ì²´ê³„

```mermaid
graph TD
    A[ì½”ë“œ ë³€ê²½] --> B{Pre-commit Hook}
    B -->|í…ŒìŠ¤íŠ¸ ì‚­ì œ?| C[âŒ ì»¤ë°‹ ì°¨ë‹¨]
    B -->|Theater Testing?| C
    B -->|âœ… í†µê³¼| D[Git Commit]
    D --> E{GitHub Actions}
    E -->|Mock > 20%?| F[âŒ PR ì°¨ë‹¨]
    E -->|Coverage < 80%?| F
    E -->|âœ… í†µê³¼| G[PR ìŠ¹ì¸ ê°€ëŠ¥]
```

### ğŸ“Š ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§
```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘     TEST INTEGRITY DASHBOARD           â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ Total Tests:    127 (â†‘2)              â•‘
â•‘ Pass Rate:      98.4%                 â•‘
â•‘ Mock Usage:     18.5% âœ…              â•‘
â•‘ Coverage:       82.3% âœ…              â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ Recent Violations:                    â•‘
â•‘ â€¢ 2h ago: Test deletion blocked       â•‘
â•‘ â€¢ 5h ago: Theater testing detected    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

## ì°¨ë‹¨ íŒ¨í„´

### 1. í…ŒìŠ¤íŠ¸ ì‚­ì œ ì‹œë„
```python
# âŒ ì°¨ë‹¨ë¨
- def test_critical_feature():
-     assert calculate_price(100) == 110
```
**ì—ëŸ¬**: "í…ŒìŠ¤íŠ¸ ì‚­ì œ ê°ì§€! ìˆ˜ì •í•˜ì„¸ìš”"

### 2. Theater Testing
```python
# âŒ ì°¨ë‹¨ë¨
def test_user_creation():
    user = create_user()
    assert user is not None  # ë„ˆë¬´ ì¶”ìƒì !
```
**ì—ëŸ¬**: "êµ¬ì²´ì ì¸ ê°’ì„ ê²€ì¦í•˜ì„¸ìš”"

### 3. Mock ê³¼ë‹¤ ì‚¬ìš©
```python
# âŒ ì°¨ë‹¨ë¨ (Mock 50% ì´ìƒ)
@mock.patch('db.connect')
@mock.patch('api.fetch')
@mock.patch('cache.get')
def test_everything_mocked():
    pass
```
**ì—ëŸ¬**: "Mock ì‚¬ìš©ë¥  20% ì´ˆê³¼"

### 4. ì„±ê¸‰í•œ ì„±ê³µ ì£¼ì¥
```bash
# AIê°€ ì‹¤íŒ¨ì¸ë° ì„±ê³µ ì£¼ì¥
"âœ… ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼!" # ì‹¤ì œë¡œëŠ” 5ê°œ ì‹¤íŒ¨
```
**ì‹œìŠ¤í…œ ê²€ì¦**: ì‹¤ì œ pytest ê²°ê³¼ì™€ ëŒ€ì¡°

## ì„¤ì • ì»¤ìŠ¤í„°ë§ˆì´ì§•

### `.tadd/config.yml`
```yaml
rules:
  test_first: true
  mock_limit: 20      # Mock ì‚¬ìš©ë¥  ì œí•œ
  coverage_min: 80    # ìµœì†Œ ì»¤ë²„ë¦¬ì§€
  
exceptions:
  - path: "legacy/*"  # ë ˆê±°ì‹œ ì½”ë“œ ì˜ˆì™¸
    reason: "ì ì§„ì  ê°œì„  ì¤‘"
```

## ë¬¸ì œ í•´ê²°

### Q: ì •ë‹¹í•œ ì´ìœ ë¡œ í…ŒìŠ¤íŠ¸ë¥¼ ì œê±°í•´ì•¼ í•  ë•Œ?
A: ì£¼ì„ìœ¼ë¡œ ëª…í™•í•œ ì´ìœ  ê¸°ë¡ í›„ ì œê±°
```python
# REMOVED: Deprecated feature - see issue #123
# def test_old_feature(): ...
```

### Q: Mockì´ ë°˜ë“œì‹œ í•„ìš”í•œ ì™¸ë¶€ APIëŠ”?
A: exceptionsì— ì¶”ê°€í•˜ê±°ë‚˜ integration testë¡œ ë¶„ë¦¬
```yaml
exceptions:
  - path: "tests/integration/*"
    reason: "ì™¸ë¶€ ì„œë¹„ìŠ¤ ì˜ì¡´"
```

### Q: CIê°€ ë„ˆë¬´ ì—„ê²©í•´ì„œ ê°œë°œì´ ì–´ë ¤ìš¸ ë•Œ?
A: ê°œë°œ ë¸Œëœì¹˜ì—ì„œëŠ” ì™„í™”, main ë¸Œëœì¹˜ì—ì„œë§Œ ì—„ê²© ì ìš©
```yaml
branch_rules:
  main: strict
  develop: relaxed
  feature/*: disabled
```

## íš¨ê³¼

### ğŸ“ˆ ë„ì… ì „í›„ ë¹„êµ
| ì§€í‘œ | ë„ì… ì „ | ë„ì… í›„ |
|------|---------|---------|
| í…ŒìŠ¤íŠ¸ ì‹ ë¢°ë„ | 60% | 95% |
| Theater Testing | 35% | 0% |
| Mock ë‚¨ìš© | 45% | 15% |
| ì‹¤ì œ ë²„ê·¸ ê°ì†Œ | - | 70% â†“ |

### ğŸ’¬ ì‚¬ìš©ì í”¼ë“œë°±
> "AIê°€ ë” ì´ìƒ í…ŒìŠ¤íŠ¸ë¥¼ ì†ì´ì§€ ëª»í•´ìš”!" - ê°œë°œì A
> 
> "ì§„ì§œ í’ˆì§ˆì´ ë³´ì¥ë˜ëŠ” ëŠë‚Œ" - íŒ€ ë¦¬ë“œ B

## ë‹¤ìŒ ë‹¨ê³„

1. **ëª¨ë‹ˆí„°ë§**: `scripts/validate_test_integrity.sh` ì •ê¸° ì‹¤í–‰
2. **ë¦¬í¬íŠ¸**: ì£¼ê°„ í…ŒìŠ¤íŠ¸ í’ˆì§ˆ ë¦¬í¬íŠ¸ ìë™ ìƒì„±
3. **ê°œì„ **: íŒ¨í„´ ë¶„ì„ í›„ ê·œì¹™ ì—…ë°ì´íŠ¸

## ì§€ì›

- ì´ìŠˆ: [GitHub Issues](https://github.com/kyuwon-shim-ARL/claude-dev-kit/issues)
- ë¬¸ì„œ: [ìƒì„¸ ë¬¸ì„œ](https://docs.claude-dev-kit.com/test-integrity)
- ìŠ¬ë™: #test-integrity ì±„ë„

---

*"í…ŒìŠ¤íŠ¸ëŠ” ê±°ì§“ë§í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. AIë„ ë§ˆì°¬ê°€ì§€ì—¬ì•¼ í•©ë‹ˆë‹¤."* ğŸ›¡ï¸