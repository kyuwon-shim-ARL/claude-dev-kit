# PRD v23: í…ŒìŠ¤íŠ¸ ìƒì„±-ì‹¤í–‰ ì™„ì „ ìë™í™” ì‹œìŠ¤í…œ

## ğŸ¯ í•µì‹¬ ë¹„ì „
Claudeê°€ ìƒì„±í•œ ëª¨ë“  í…ŒìŠ¤íŠ¸ê°€ ìë™ìœ¼ë¡œ GitHub Actions CI/CD íŒŒì´í”„ë¼ì¸ì— í†µí•©ë˜ì–´ ì§€ì†ì ìœ¼ë¡œ ì‹¤í–‰ë˜ëŠ” ì™„ì „ ìë™í™” ì‹œìŠ¤í…œ

## ğŸ“Œ ë¬¸ì œ ì •ì˜
- **í˜„ì¬**: í”„ë¡¬í”„íŠ¸ë¡œ í…ŒìŠ¤íŠ¸ ìƒì„± â†’ ë¡œì»¬ ì‹¤í–‰ â†’ ë
- **ë¬¸ì œì **: ìƒì„±ëœ í…ŒìŠ¤íŠ¸ê°€ ì¼íšŒì„±, CI/CD ë‹¨ì ˆ
- **ê²°ê³¼**: íšŒê·€ í…ŒìŠ¤íŠ¸ ë¶ˆê°€, í’ˆì§ˆ ë³´ì¦ ì²´ê³„ ë¶€ì¬

## ğŸ—ï¸ ì†”ë£¨ì…˜: Test-Actions Bridge System

### 1. í…ŒìŠ¤íŠ¸ ìƒì„± í‘œì¤€í™”

#### /êµ¬í˜„ ëª…ë ¹ì–´ ê°œì„ 
```yaml
# ê¸°ì¡´ í”„ë¡¬í”„íŠ¸
/êµ¬í˜„ "ë¡œê·¸ì¸ ê¸°ëŠ¥"
â†’ ì½”ë“œ ìƒì„± + ê°„ë‹¨í•œ í…ŒìŠ¤íŠ¸

# ê°œì„ ëœ í”„ë¡¬í”„íŠ¸ (ìë™ CI ì—°ë™)
/êµ¬í˜„ "ë¡œê·¸ì¸ ê¸°ëŠ¥"
â†’ ì½”ë“œ ìƒì„±
â†’ í…ŒìŠ¤íŠ¸ ìƒì„± (í‘œì¤€ êµ¬ì¡°)
â†’ .github/tests/ë¡œ ìë™ ì €ì¥
â†’ CI ì›Œí¬í”Œë¡œìš° ìë™ ì—…ë°ì´íŠ¸
```

#### í‘œì¤€ í…ŒìŠ¤íŠ¸ êµ¬ì¡°
```python
# tests/auto_generated/test_[timestamp]_[feature].py
"""
Generated by Claude on 2025-08-30
Feature: ë¡œê·¸ì¸ ê¸°ëŠ¥
Coverage: Unit + Integration
"""

import pytest
from src.auth import login

class TestAutoGenerated_Login:
    """ìë™ ìƒì„±ëœ í…ŒìŠ¤íŠ¸ëŠ” íŠ¹ë³„í•œ ë„¤ì´ë° ê·œì¹™ ë”°ë¦„"""
    
    @pytest.mark.unit
    @pytest.mark.ci_required  # CIì—ì„œ í•„ìˆ˜ ì‹¤í–‰
    def test_valid_login(self):
        # Claudeê°€ ìƒì„±í•œ í…ŒìŠ¤íŠ¸ ë¡œì§
        pass
    
    @pytest.mark.integration
    @pytest.mark.ci_optional  # CIì—ì„œ ì„ íƒì  ì‹¤í–‰
    def test_login_workflow(self):
        # í†µí•© í…ŒìŠ¤íŠ¸ ë¡œì§
        pass
```

### 2. ìë™ CI ë“±ë¡ ì‹œìŠ¤í…œ

#### í…ŒìŠ¤íŠ¸ ë ˆì§€ìŠ¤íŠ¸ë¦¬
```yaml
# .github/test-registry.yml
# Claudeê°€ í…ŒìŠ¤íŠ¸ ìƒì„±í•  ë•Œë§ˆë‹¤ ìë™ ì—…ë°ì´íŠ¸

tests:
  - id: test_2025_08_30_login
    path: tests/auto_generated/test_20250830_login.py
    created_by: claude
    date: 2025-08-30
    feature: ë¡œê·¸ì¸ ê¸°ëŠ¥
    type: [unit, integration]
    priority: high
    ci_runs: always  # always | pr_only | nightly
    
  - id: test_2025_08_29_payment
    path: tests/auto_generated/test_20250829_payment.py
    created_by: claude
    date: 2025-08-29
    feature: ê²°ì œ ì‹œìŠ¤í…œ
    type: [unit, integration, e2e]
    priority: critical
    ci_runs: always
```

#### ë™ì  ì›Œí¬í”Œë¡œìš° ìƒì„±
```yaml
# .github/workflows/dynamic-tests.yml
# ë ˆì§€ìŠ¤íŠ¸ë¦¬ ê¸°ë°˜ìœ¼ë¡œ ìë™ ìƒì„±ë˜ëŠ” ì›Œí¬í”Œë¡œìš°

name: Auto-Generated Tests
on: [push, pull_request]

jobs:
  run-claude-tests:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        test: ${{ fromJson(needs.load-tests.outputs.tests) }}
    
    steps:
      - name: Run Test ${{ matrix.test.id }}
        run: |
          pytest ${{ matrix.test.path }} \
            --cov=src \
            --cov-report=xml:coverage-${{ matrix.test.id }}.xml
      
      - name: Upload Coverage
        uses: codecov/codecov-action@v3
        with:
          file: coverage-${{ matrix.test.id }}.xml
          flags: ${{ matrix.test.feature }}
```

### 3. í”„ë¡¬í”„íŠ¸-Actions í†µí•© í”Œë¡œìš°

#### Phase 1: í…ŒìŠ¤íŠ¸ ìƒì„± ì‹œ
```python
# Claudeê°€ ì‹¤í–‰í•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸
def register_test_to_ci(test_file, metadata):
    """ìƒì„±ëœ í…ŒìŠ¤íŠ¸ë¥¼ CIì— ìë™ ë“±ë¡"""
    
    # 1. í…ŒìŠ¤íŠ¸ íŒŒì¼ ì €ì¥
    save_test_file(test_file, "tests/auto_generated/")
    
    # 2. ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì—…ë°ì´íŠ¸
    update_test_registry({
        "id": generate_test_id(),
        "path": test_file.path,
        "created_by": "claude",
        "date": datetime.now(),
        "feature": metadata.feature,
        "type": metadata.test_types,
        "priority": metadata.priority,
        "ci_runs": determine_ci_frequency(metadata)
    })
    
    # 3. GitHub Actions ì›Œí¬í”Œë¡œìš° ì¬ìƒì„±
    regenerate_workflow(".github/workflows/dynamic-tests.yml")
    
    # 4. ì»¤ë°‹ ë° í‘¸ì‹œ (ì˜µì…˜)
    if auto_commit_enabled:
        git_commit_and_push("feat: Add auto-generated tests for {feature}")
```

#### Phase 2: CI ì‹¤í–‰ ì‹œ
```yaml
# GitHub Actionsì—ì„œ ì‹¤í–‰ë˜ëŠ” í”Œë¡œìš°
steps:
  - name: Load Test Registry
    id: registry
    run: |
      python scripts/load_test_registry.py > tests.json
      echo "tests=$(cat tests.json)" >> $GITHUB_OUTPUT
  
  - name: Filter Tests by Priority
    run: |
      # PR: high, criticalë§Œ ì‹¤í–‰
      # main: ëª¨ë“  í…ŒìŠ¤íŠ¸ ì‹¤í–‰
      python scripts/filter_tests.py \
        --branch ${{ github.ref }} \
        --event ${{ github.event_name }}
  
  - name: Run Filtered Tests
    run: |
      pytest @filtered_tests.txt \
        --parallel 4 \
        --timeout 300
```

### 4. í…ŒìŠ¤íŠ¸ ê²°ê³¼ í”¼ë“œë°± ë£¨í”„

#### ì‹¤íŒ¨ ë¶„ì„ ë° ìë™ ìˆ˜ì •
```python
# scripts/analyze_test_failures.py
def analyze_and_fix_failures():
    """í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ë¥¼ ë¶„ì„í•˜ê³  Claudeì—ê²Œ ìˆ˜ì • ìš”ì²­"""
    
    failures = parse_test_results(".github/test-results/")
    
    for failure in failures:
        if failure.is_flaky:
            # Flaky í…ŒìŠ¤íŠ¸ëŠ” ì¬ì‹¤í–‰ ë§ˆí¬
            mark_for_retry(failure.test_id)
        
        elif failure.is_outdated:
            # êµ¬í˜„ ë³€ê²½ìœ¼ë¡œ ì¸í•œ ì‹¤íŒ¨
            prompt = f"""
            í…ŒìŠ¤íŠ¸ {failure.test_id}ê°€ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.
            ì›ì¸: {failure.reason}
            ìŠ¤íƒíŠ¸ë ˆì´ìŠ¤: {failure.stacktrace}
            
            ì´ í…ŒìŠ¤íŠ¸ë¥¼ í˜„ì¬ êµ¬í˜„ì— ë§ê²Œ ìˆ˜ì •í•´ì£¼ì„¸ìš”.
            """
            # Claudeì—ê²Œ ìˆ˜ì • ìš”ì²­ (ìë™í™” ê°€ëŠ¥)
            request_test_fix(prompt)
```

#### ì»¤ë²„ë¦¬ì§€ ê¸°ë°˜ í…ŒìŠ¤íŠ¸ ìƒì„± ìš”ì²­
```python
# scripts/coverage_gap_detector.py
def detect_coverage_gaps():
    """ì»¤ë²„ë¦¬ì§€ ë¶€ì¡± ì˜ì—­ ê°ì§€ ë° í…ŒìŠ¤íŠ¸ ìƒì„± ìš”ì²­"""
    
    coverage_report = load_coverage_report()
    
    gaps = find_uncovered_code(coverage_report)
    
    for gap in gaps:
        if gap.coverage < 60:  # 60% ë¯¸ë§Œ
            prompt = f"""
            ë‹¤ìŒ ì½”ë“œì˜ í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ê°€ {gap.coverage}%ì…ë‹ˆë‹¤:
            íŒŒì¼: {gap.file}
            í•¨ìˆ˜: {gap.function}
            ë¼ì¸: {gap.lines}
            
            ì´ ë¶€ë¶„ì„ ì»¤ë²„í•˜ëŠ” í…ŒìŠ¤íŠ¸ë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”.
            """
            # ìë™ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ ìƒì„± ìš”ì²­
            request_test_generation(prompt)
```

### 5. ì‹¤ì œ êµ¬í˜„ ì˜ˆì‹œ

#### /êµ¬í˜„ ëª…ë ¹ì–´ ì‹¤í–‰ ì‹œ
```bash
# ì‚¬ìš©ì ì…ë ¥
/êµ¬í˜„ "ì‚¬ìš©ì í”„ë¡œí•„ ì—…ë°ì´íŠ¸ API"

# Claude ì‹¤í–‰ ê³¼ì •
1. API ì½”ë“œ ìƒì„± â†’ src/api/profile.py
2. í…ŒìŠ¤íŠ¸ ìƒì„± â†’ tests/auto_generated/test_20250830_profile_api.py
3. ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì—…ë°ì´íŠ¸ â†’ .github/test-registry.yml
4. ì›Œí¬í”Œë¡œìš° ì¬ìƒì„± â†’ .github/workflows/dynamic-tests.yml
5. ë¡œì»¬ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ â†’ pytest tests/auto_generated/test_20250830_profile_api.py
6. ê²°ê³¼ í‘œì‹œ â†’ "âœ… í…ŒìŠ¤íŠ¸ í†µê³¼, CIì— ìë™ ë“±ë¡ë¨"
```

#### GitHub Actions ì‹¤í–‰ ì‹œ
```yaml
# ìë™ìœ¼ë¡œ ì‹¤í–‰ë˜ëŠ” ê³¼ì •
1. Push/PR íŠ¸ë¦¬ê±°
2. í…ŒìŠ¤íŠ¸ ë ˆì§€ìŠ¤íŠ¸ë¦¬ ë¡œë“œ
3. ìš°ì„ ìˆœìœ„ë³„ í•„í„°ë§
4. ë³‘ë ¬ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
5. ì»¤ë²„ë¦¬ì§€ ë¦¬í¬íŠ¸
6. ì‹¤íŒ¨ ì‹œ ìë™ ë¶„ì„
7. Slack/Discord ì•Œë¦¼
```

## ğŸ“Š ê¸°ëŒ€ íš¨ê³¼

### ì •ëŸ‰ì  íš¨ê³¼
- **í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€**: 40% â†’ 80%+ (ìë™ ìƒì„±)
- **íšŒê·€ ë²„ê·¸ ê°ì†Œ**: 70% ê°ì†Œ (ì§€ì†ì  ì‹¤í–‰)
- **í…ŒìŠ¤íŠ¸ ì‘ì„± ì‹œê°„**: 80% ì ˆê° (ìë™í™”)
- **CI í™œìš©ë„**: 100% (ëª¨ë“  í…ŒìŠ¤íŠ¸ ìë™ ë“±ë¡)

### ì •ì„±ì  íš¨ê³¼
- **ê°œë°œì ë¶€ë‹´ ê°ì†Œ**: í…ŒìŠ¤íŠ¸ ì‘ì„±/ê´€ë¦¬ ìë™í™”
- **í’ˆì§ˆ ë³´ì¦ ê°•í™”**: ëª¨ë“  ê¸°ëŠ¥ì´ CIë¡œ ê²€ì¦
- **í”¼ë“œë°± ì†ë„**: ì¦‰ê°ì ì¸ í…ŒìŠ¤íŠ¸ ê²°ê³¼
- **í™•ì¥ì„±**: ë¬´ì œí•œ í…ŒìŠ¤íŠ¸ ì¶”ê°€ ê°€ëŠ¥

## ğŸš€ êµ¬í˜„ ë¡œë“œë§µ

### Week 1: ê¸°ë°˜ êµ¬ì¶•
```bash
# 1. í…ŒìŠ¤íŠ¸ ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì‹œìŠ¤í…œ
touch .github/test-registry.yml
python scripts/create_registry_manager.py

# 2. ë™ì  ì›Œí¬í”Œë¡œìš° ìƒì„±ê¸°
python scripts/create_workflow_generator.py

# 3. í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ ì—…ë°ì´íŠ¸
update_slash_commands("/êµ¬í˜„", include_test_generation=True)
```

### Week 2: í†µí•© êµ¬í˜„
```bash
# 1. Claude-Actions ë¸Œë¦¿ì§€
python scripts/implement_test_bridge.py

# 2. ìë™ ë“±ë¡ ì‹œìŠ¤í…œ
python scripts/implement_auto_registration.py

# 3. ì‹¤íŒ¨ ë¶„ì„ê¸°
python scripts/implement_failure_analyzer.py
```

### Week 3: ìµœì í™” ë° í™•ì¥
```bash
# 1. ë³‘ë ¬ ì‹¤í–‰ ìµœì í™”
optimize_parallel_execution()

# 2. ì»¤ë²„ë¦¬ì§€ ê°­ íƒì§€
implement_coverage_gap_detector()

# 3. ìë™ ìˆ˜ì • ì‹œìŠ¤í…œ
implement_auto_fix_system()
```

## ğŸ’¡ í•µì‹¬ ì°¨ë³„í™”

### ê¸°ì¡´ ë°©ì‹ vs ìƒˆë¡œìš´ ë°©ì‹

| í•­ëª© | ê¸°ì¡´ (í”„ë¡¬í”„íŠ¸ë§Œ) | ìƒˆë¡œìš´ ë°©ì‹ (Actions í†µí•©) |
|------|----------------|------------------------|
| í…ŒìŠ¤íŠ¸ ìƒì„± | ì¼íšŒì„± | ì˜êµ¬ ë³´ì¡´ + CI ë“±ë¡ |
| ì‹¤í–‰ ì£¼ê¸° | ìˆ˜ë™, ë¡œì»¬ë§Œ | ìë™, ëª¨ë“  Push/PR |
| íšŒê·€ í…ŒìŠ¤íŠ¸ | ë¶ˆê°€ëŠ¥ | ì™„ì „ ìë™í™” |
| ì»¤ë²„ë¦¬ì§€ ì¶”ì  | ì—†ìŒ | ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§ |
| ì‹¤íŒ¨ ì²˜ë¦¬ | ìˆ˜ë™ í™•ì¸ | ìë™ ë¶„ì„ + ìˆ˜ì • ìš”ì²­ |
| í™•ì¥ì„± | ì œí•œì  | ë¬´ì œí•œ |

## âœ… ì„±ê³µ ê¸°ì¤€

- [ ] ëª¨ë“  `/êµ¬í˜„` ëª…ë ¹ì´ ìë™ìœ¼ë¡œ CI í…ŒìŠ¤íŠ¸ ìƒì„±
- [ ] ìƒì„±ëœ í…ŒìŠ¤íŠ¸ 100% GitHub Actions ì—°ë™
- [ ] í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ ì‹œ ìë™ ë¶„ì„ ë¦¬í¬íŠ¸
- [ ] ì»¤ë²„ë¦¬ì§€ 80% ì´ìƒ ìë™ ë‹¬ì„±
- [ ] íšŒê·€ ë²„ê·¸ 70% ê°ì†Œ

## ğŸ”§ í•„ìš” ë„êµ¬

### ì¦‰ì‹œ êµ¬í˜„ ê°€ëŠ¥
```yaml
# .github/workflows/test-bridge.yml
name: Test Bridge System
on:
  workflow_dispatch:  # ìˆ˜ë™ íŠ¸ë¦¬ê±°ë¡œ ì‹œì‘
    inputs:
      test_path:
        description: 'Generated test path'
        required: true

jobs:
  run-generated-test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Run Claude-generated test
        run: |
          pytest ${{ github.event.inputs.test_path }}
```

### ìŠ¤í¬ë¦½íŠ¸ í…œí”Œë¦¿
```python
# scripts/register_test.py
#!/usr/bin/env python3
"""Claudeê°€ í…ŒìŠ¤íŠ¸ ìƒì„± ì‹œ ìë™ ì‹¤í–‰"""

import yaml
import sys
from pathlib import Path

def register_test(test_file, metadata):
    registry_path = Path(".github/test-registry.yml")
    
    # ë ˆì§€ìŠ¤íŠ¸ë¦¬ ë¡œë“œ ë˜ëŠ” ìƒì„±
    if registry_path.exists():
        with open(registry_path) as f:
            registry = yaml.safe_load(f)
    else:
        registry = {"tests": []}
    
    # ìƒˆ í…ŒìŠ¤íŠ¸ ì¶”ê°€
    registry["tests"].append({
        "id": f"test_{metadata['timestamp']}_{metadata['feature']}",
        "path": str(test_file),
        "created_by": "claude",
        "date": metadata['date'],
        "feature": metadata['feature'],
        "type": metadata['types'],
        "priority": metadata['priority'],
        "ci_runs": "always"
    })
    
    # ì €ì¥
    with open(registry_path, 'w') as f:
        yaml.dump(registry, f, default_flow_style=False)
    
    print(f"âœ… Test registered: {test_file}")
    return True

if __name__ == "__main__":
    # Claudeê°€ í˜¸ì¶œí•  ë•Œ ì‚¬ìš©
    register_test(sys.argv[1], eval(sys.argv[2]))
```

---

*ì´ ì‹œìŠ¤í…œìœ¼ë¡œ í”„ë¡¬í”„íŠ¸ ê¸°ë°˜ ê°œë°œê³¼ ì—”í„°í”„ë¼ì´ì¦ˆê¸‰ CI/CDê°€ ì™„ë²½í•˜ê²Œ í†µí•©ë©ë‹ˆë‹¤.*