<!--
@meta
id: analysis_20250905_1120_restructured
type: analysis
scope: operational
status: published
created: 2025-09-05
updated: 2025-09-05
tags: commands, 분석.md, 5-stage-workflow, automated
related: slash-command-restructuring-v31.md
-->

# /분석 - 5단계 완전 분석 사이클 v31.0

## 🎯 명령어 개요
**완전한 분석 워크플로우**: 탐색 → 수렴 → 정제 → 보고서 → 정리

## 🔄 5단계 자동 진행 워크플로우

### **1단계: 탐색** 
- 현황 파악 및 데이터 수집
- 관련 파일, 코드, 로그 자동 스캔
- 이해관계자 및 영향 범위 식별

### **2단계: 수렴**
- 패턴 식별 및 핵심 이슈 도출
- 데이터 상관관계 분석
- 근본 원인 추적

### **3단계: 정제**
- 분석 결과 구조화 및 검증
- 가설 검증 및 결론 도출
- 액션 아이템 우선순위화

### **4단계: 보고서**
- docs/analysis/ 자동 저장
- 시각화 및 요약 생성
- 인덱스 자동 업데이트

### **5단계: 정리**
- 컨텍스트 아카이빙
- 액션 아이템 추출
- 다음 단계 추천 (/기획 or /구현 제안)

## 사용법
```
/분석 "분석하고 싶은 내용"
```

## Claude 실행 프로세스

### 1단계: 분석 수행
```python
def perform_analysis(request):
    # 분석 유형 자동 판단
    analysis_type = detect_type(request)
    
    # 분석 실행
    results = analyze(request, analysis_type)
    
    return results
```

### 2단계: 마크다운 문서 생성
```python
def create_document(request, results):
    doc = f"""# {extract_title(request)}

## 📅 분석 정보
- **날짜**: {datetime.now().strftime('%Y-%m-%d %H:%M')}
- **요청**: {request}
- **유형**: {analysis_type}

## 📊 분석 결과
{results}

## 💾 관련 파일
- 데이터: {data_paths if exists}
- 코드: {code_paths if exists}

## 🔗 관련 분석
- {find_related_analyses()}
"""
    return doc
```

### 3단계: 자동 저장 (핵심!)
```python
def auto_save_analysis(doc, request):
    # 파일명 생성: 날짜-핵심키워드
    date_str = datetime.now().strftime('%Y-%m-%d')
    title = extract_keywords(request)[:30]
    filename = f"{date_str}-{title}.md"
    
    # 저장 경로
    filepath = f"docs/analysis/{filename}"
    
    # Write 도구로 실제 저장
    write_file(filepath, doc)
    
    # 인덱스 업데이트
    update_index(filepath, title)
    
    return filepath
```

### 4단계: 사용자 알림
```python
def notify_user(filepath):
    print(f"""
✅ 분석 완료 및 자동 저장됨
📁 저장 위치: {filepath}
🔍 다시 보기: cat {filepath}
""")
```

## 실제 실행 예시

### 사용자 입력:
```
/분석 "최근 API 응답시간이 느려진 원인 분석"
```

### Claude 실행:
1. API 로그 분석
2. 성능 메트릭 수집
3. 병목 지점 식별
4. 분석 결과 정리
5. **자동으로 파일 저장**: `docs/analysis/2024-01-20-API응답시간분석.md`
6. 사용자에게 알림:
```
✅ 분석 완료 및 자동 저장됨
📁 저장 위치: docs/analysis/2024-01-20-API응답시간분석.md
🔍 다시 보기: cat docs/analysis/2024-01-20-API응답시간분석.md
```

## 저장되는 파일 구조

```markdown
# API 응답시간 분석

## 📅 분석 정보
- **날짜**: 2024-01-20 14:30
- **요청**: 최근 API 응답시간이 느려진 원인 분석
- **유형**: performance

## 📊 분석 결과

### 주요 발견사항
1. DB 쿼리 최적화 필요 (N+1 문제)
   - /api/users 엔드포인트: 평균 2.3s → 0.3s 예상
2. 캐시 미적용 구간 발견
   - 정적 데이터 캐싱 시 50% 개선 가능
3. 불필요한 미들웨어 체이닝
   - 3개 미들웨어 제거 가능

### 성능 측정값
- 현재 평균 응답시간: 1.8s
- P95: 3.2s  
- P99: 5.1s

### 권장 조치
1. DB 인덱스 추가
2. Redis 캐시 구현
3. 미들웨어 리팩토링

## 💾 관련 파일
- 로그: logs/api/2024-01-20.log
- 메트릭: metrics/performance/

## 🔗 관련 분석
- [2024-01-15-DB쿼리최적화.md](2024-01-15-DB쿼리최적화.md)
```

## 인덱스 자동 업데이트

### docs/analysis/index.md (자동 생성)
```markdown
# 분석 보고서 인덱스

## 최근 분석
- 2024-01-20: [API 응답시간 분석](2024-01-20-API응답시간분석.md)
- 2024-01-19: [메모리 누수 조사](2024-01-19-메모리누수조사.md)
- 2024-01-18: [사용자 행동 패턴](2024-01-18-사용자행동패턴.md)

## 카테고리별
### Performance
- API 응답시간 분석
- 메모리 누수 조사

### User Analytics  
- 사용자 행동 패턴
```

## 장점

1. **영구 보존**: 분석 결과가 파일로 저장되어 영구 보존
2. **자동화**: 사용자가 따로 저장 명령 불필요
3. **체계적**: 일관된 형식과 구조
4. **검색 가능**: 파일명과 인덱스로 쉽게 찾기
5. **공유 가능**: 마크다운 파일로 누구나 읽기 가능

## 핵심 차별점

**기존 방식**:
```
/분석 "..." → 대화창 출력 → 끝
```

**새로운 방식**:
```
/분석 "..." → 대화창 출력 + 자동 파일 저장 + 인덱스 업데이트
```

사용자는 똑같이 사용하지만, 결과는 자동으로 영구 보존됩니다!

## 🎯 최종 산출물

**모든 분석은 다음을 포함하여 완료됩니다:**

1. **분석 보고서** (시각화 포함)
   - 구조화된 분석 결과
   - 차트 및 그래프 자동 생성
   - 핵심 발견사항 요약

2. **액션 아이템 리스트**
   - 우선순위별 조치 사항
   - 담당자 및 일정 제안
   - 성공 측정 기준

3. **다음 단계 추천**
   - `/기획` 추천: 새로운 기능이 필요한 경우
   - `/구현` 추천: 즉시 수정 가능한 경우
   - 추가 분석 필요: 더 깊은 조사가 필요한 경우